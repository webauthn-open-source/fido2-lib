<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>MdsCollection - Documentation</title>

    <script src="scripts/prettify/prettify.js"></script>
    <script src="scripts/prettify/lang-css.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc.css">
</head>
<body>

<input type="checkbox" id="nav-trigger" class="nav-trigger" />
<label for="nav-trigger" class="navicon-button x">
  <div class="navicon"></div>
</label>

<label for="nav-trigger" class="overlay"></label>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Classes</h3><ul><li><a href="Fido2AssertionResult.html">Fido2AssertionResult</a></li><li><a href="Fido2AttestationResult.html">Fido2AttestationResult</a></li><li><a href="Fido2Lib.html">Fido2Lib</a><ul class='methods'><li data-type='method'><a href="Fido2Lib.html#.addAttestationFormat">addAttestationFormat</a></li><li data-type='method'><a href="Fido2Lib.html#.addExtension">addExtension</a></li><li data-type='method'><a href="Fido2Lib.html#.addMdsCollection">addMdsCollection</a></li><li data-type='method'><a href="Fido2Lib.html#.clearMdsCollections">clearMdsCollections</a></li><li data-type='method'><a href="Fido2Lib.html#.createMdsCollection">createMdsCollection</a></li><li data-type='method'><a href="Fido2Lib.html#.deleteAllAttestationFormats">deleteAllAttestationFormats</a></li><li data-type='method'><a href="Fido2Lib.html#.deleteAllExtensions">deleteAllExtensions</a></li><li data-type='method'><a href="Fido2Lib.html#.findMdsEntry">findMdsEntry</a></li><li data-type='method'><a href="Fido2Lib.html#assertionOptions">assertionOptions</a></li><li data-type='method'><a href="Fido2Lib.html#assertionResult">assertionResult</a></li><li data-type='method'><a href="Fido2Lib.html#attestationOptions">attestationOptions</a></li><li data-type='method'><a href="Fido2Lib.html#attestationResult">attestationResult</a></li><li data-type='method'><a href="Fido2Lib.html#disableExtension">disableExtension</a></li><li data-type='method'><a href="Fido2Lib.html#enableExtension">enableExtension</a></li><li data-type='method'><a href="Fido2Lib.html#setExtensionOptions">setExtensionOptions</a></li></ul></li><li><a href="Fido2Result.html">Fido2Result</a></li><li><a href="MdsCollection.html">MdsCollection</a><ul class='methods'><li data-type='method'><a href="MdsCollection.html#addEntry">addEntry</a></li><li data-type='method'><a href="MdsCollection.html#addToc">addToc</a></li><li data-type='method'><a href="MdsCollection.html#findEntry">findEntry</a></li><li data-type='method'><a href="MdsCollection.html#getToc">getToc</a></li><li data-type='method'><a href="MdsCollection.html#validate">validate</a></li></ul></li><li><a href="MdsEntry.html">MdsEntry</a></li></ul><h3>Global</h3><ul><li><a href="global.html#parseAttestationObject">parseAttestationObject</a></li><li><a href="global.html#parseClientResponse">parseClientResponse</a></li></ul>
</nav>

<div id="main">
    
    <h1 class="page-title">MdsCollection</h1>
    

    




<section>

<header>
    
        <h2>
        MdsCollection
        </h2>
        
            <div class="class-description"><p>A class for managing, validating, and finding metadata that describes authenticators</p>
<p>This class does not do any of the downloading of the TOC or any of the entries in the TOC,
but assumes that you can download the data and pass it to this class. This allows for cleverness
and flexibility in how, when, and what is downloaded -- while at the same time allowing this class
to take care of the not-so-fun parts of validating signatures, hashes, certificat chains, and certificate
revocation lists.</p>
<p>Typically this will be created through Fido2Lib#createMdsCollection and then set as the global
MDS collection via Fido2Lib#setMdsCollection</p></div>
        
    
</header>

<article>
    <div class="container-overview">
    
        

    
    <h2>Constructor</h2>
    

    <h4 class="name" id="MdsCollection"><span class="type-signature"></span>new MdsCollection<span class="signature">()</span><span class="type-signature"> &rarr; {<a href="MdsCollection.html">MdsCollection</a>}</span></h4>

    




<dl class="details">

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="mds.js.html">mds.js</a>, <a href="mds.js.html#line275">line 275</a>
    </li></ul></dd>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
</dl>





<div class="description">
    <p>Creates a new MdsCollection</p>
</div>









    <h5>Example</h5>
    
    <pre class="prettyprint"><code>var mc = Fido2Lib.createMdsCollection()
// download TOC from https://mds.fidoalliance.org ...
var tocObj = await mc.addToc(tocBase64);
tocObj.entries.forEach((entry) => {
    // download entry.url ...
    mc.addEntry(entryBase64);
});
Fido2Lib.setMdsCollection(mc); // performs validation
var entry = Fido2Lib.findEntry("4e4e#4005");</code></pre>
















<h5>Returns:</h5>

        
<div class="param-desc">
    <p>The MDS collection that was created. The freshly created MDS collection has
no Table of Contents (TOC) or entries, which must be added through addToc and addEntry, respectively.</p>
</div>



<dl class="param-type">
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type"><a href="MdsCollection.html">MdsCollection</a></span>


    </dd>
</dl>

    


    
    </div>

    

    

    

     

    

    

    
        <h3 class="subsection-title">Methods</h3>

        
            

    

    <h4 class="name" id="addEntry"><span class="type-signature"></span>addEntry<span class="signature">(entryStr)</span><span class="type-signature"></span></h4>

    




<dl class="details">

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="mds.js.html">mds.js</a>, <a href="mds.js.html#line365">line 365</a>
    </li></ul></dd>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
</dl>





<div class="description">
    <p>Parses and adds a new MDS entry to the collection. The entry will not be available
through findEntry until validate has been called</p>
</div>











    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>entryStr</code></td>
            

            <td class="type">
            
                
<span class="param-type">String</span>


            
            </td>

            

            

            <td class="description last"><p>The base64url encoded entry, most likely downloaded from
the URL that was found in the Table of Contents (TOC)</p></td>
        </tr>

    
    </tbody>
</table>
















        
            

    

    <h4 class="name" id="addToc"><span class="type-signature">(async) </span>addToc<span class="signature">(tocStr, rootCert, crls)</span><span class="type-signature"> &rarr; {Promise.&lt;Object>}</span></h4>

    




<dl class="details">

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="mds.js.html">mds.js</a>, <a href="mds.js.html#line307">line 307</a>
    </li></ul></dd>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
</dl>





<div class="description">
    <p>Validates and stores the Table of Contents (TOC) for future reference. This method validates
the TOC JSON Web Token (JWT) signature, as well as the certificate chain. The certiciate chain
is validated using the <code>rootCert</code> and <code>crls</code> that are provided.</p>
</div>











    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>tocStr</code></td>
            

            <td class="type">
            
                
<span class="param-type">String</span>


            
            </td>

            

            

            <td class="description last"><p>The base64url encoded Table of Contents, as described in the <a href="https://fidoalliance.org/specs/fido-v2.0-id-20180227/fido-metadata-service-v2.0-id-20180227.html">FIDO Metadata Service specification</a></p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>rootCert</code></td>
            

            <td class="type">
            
                
<span class="param-type">Array.&lt;String></span>
|

<span class="param-type">Array.&lt;ArrayBuffer></span>
|

<span class="param-type">String</span>
|

<span class="param-type">ArrayBuffer</span>
|

<span class="param-type">undefined</span>


            
            </td>

            

            

            <td class="description last"><p>One or more root certificates that serve as a trust anchor for the Metadata Service.
Certificate format is flexible, and can be a PEM string, a base64 encoded string, or an ArrayBuffer, provieded that each of those formats can be decoded to valid ASN.1
If the <code>rootCert</code> is <code>undefined</code>, then the default <a href="https://mds.fidoalliance.org/Root.cer">FIDO MDS root certificate</a> will be used.</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>crls</code></td>
            

            <td class="type">
            
                
<span class="param-type">Array.&lt;String></span>
|

<span class="param-type">Array.&lt;ArrayBuffer></span>


            
            </td>

            

            

            <td class="description last"><p>An array of Certificate Revocation Lists (CRLs) that should be used when validating
the certificate chain. Like <code>rootCert</code> the format of the CRLs is flexible and can be PEM encoded, base64 encoded, or an ArrayBuffer
provied that the CRL contains valid ASN.1 encoding.</p></td>
        </tr>

    
    </tbody>
</table>














<h5>Returns:</h5>

        
<div class="param-desc">
    <p>Returns a Promise that resolves to a TOC object, or that rejects with an error.</p>
</div>



<dl class="param-type">
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Promise.&lt;Object></span>


    </dd>
</dl>

    


        
            

    

    <h4 class="name" id="findEntry"><span class="type-signature"></span>findEntry<span class="signature">(id)</span><span class="type-signature"> &rarr; {<a href="MdsEntry.html">MdsEntry</a>|null}</span></h4>

    




<dl class="details">

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="mds.js.html">mds.js</a>, <a href="mds.js.html#line459">line 459</a>
    </li></ul></dd>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
</dl>





<div class="description">
    <p>Looks up an entry by AAID, AAGUID, or attestationCertificateKeyIdentifiers.
Only entries that have been validated will be found.</p>
</div>











    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>id</code></td>
            

            <td class="type">
            
                
<span class="param-type">String</span>
|

<span class="param-type">ArrayBuffer</span>


            
            </td>

            

            

            <td class="description last"><p>The AAID, AAGUID, or attestationCertificateKeyIdentifiers of the entry to find</p></td>
        </tr>

    
    </tbody>
</table>














<h5>Returns:</h5>

        
<div class="param-desc">
    <p>The MDS entry that was found, or null if no entry was found.</p>
</div>



<dl class="param-type">
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type"><a href="MdsEntry.html">MdsEntry</a></span>
|

<span class="param-type">null</span>


    </dd>
</dl>

    


        
            

    

    <h4 class="name" id="getToc"><span class="type-signature"></span>getToc<span class="signature">()</span><span class="type-signature"> &rarr; {Object|null}</span></h4>

    




<dl class="details">

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="mds.js.html">mds.js</a>, <a href="mds.js.html#line355">line 355</a>
    </li></ul></dd>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
</dl>





<div class="description">
    <p>Returns the parsed and validated Table of Contents object from getToc</p>
</div>























<h5>Returns:</h5>

        
<div class="param-desc">
    <p>Returns the TOC if one has been provided to getToc
or <code>null</code> if no TOC has been provided yet.</p>
</div>



<dl class="param-type">
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Object</span>
|

<span class="param-type">null</span>


    </dd>
</dl>

    


        
            

    

    <h4 class="name" id="validate"><span class="type-signature"></span>validate<span class="signature">()</span><span class="type-signature"></span></h4>

    




<dl class="details">

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="mds.js.html">mds.js</a>, <a href="mds.js.html#line390">line 390</a>
    </li></ul></dd>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
</dl>





<div class="description">
    <p>Validates all entries that have been added. Note that <a href="MdsCollection.html#findEntry">MdsCollection#findEntry</a>
will not find an <a href="MdsEntry.html">MdsEntry</a> until it has been validated.</p>
</div>





















<h5>Throws:</h5>

        

<dl>
    <dt>
        <div class="param-desc">
        <p>If a validation error occurs</p>
        </div>
    </dt>
    <dd></dd>
    <dt>
        <dl>
            <dt>
                Type
            </dt>
            <dd>
                
<span class="param-type">Error</span>


            </dd>
        </dl>
    </dt>
    <dd></dd>
</dl>


    




        
    

    

    
</article>

</section>




</div>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.6.6</a> on Sun Nov 29 2020 10:25:04 GMT+0000 (UTC) using the <a href="https://github.com/clenemt/docdash">docdash</a> theme.
</footer>

<script>prettyPrint();</script>
<script src="scripts/linenumber.js"></script>
</body>
</html>